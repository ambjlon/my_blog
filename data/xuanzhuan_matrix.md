### 问题
![](/static/blog_pic/xuanzhuan_matrix.png)  
标记坐标(0,0)的位置的序号为1, 然后从坐标为(0,0)的位置开始沿着红线所示的路径顺时针旋转, 每经过一个位置序号加1, 这样每个位置都对分配到一个正整数的序号.  

+ 给出一个序号, 求这个序号对应的坐标.
+ 给出一个坐标, 求这个坐标对应的序号.

### 求解
#### 根据序号求坐标
把路径分成一圈一圈的, 如图中绿线框所标. 图中的黄色位置可以看做每一圈的起始位置.  

+ 第1圈从(0,0)开始, 到(0,-1)结束, 总共4个.
+ 第2圈从(-1,-1)开始, 到(-1,-2)结束, 总共12个.
+ 第3圈从(-2,-2)开始, 到(-2,-3)结束, 总共20个.
+ 第4圈从(-3,-3)开始, 到(-3,-4)结束, 总共28个.
+ ...
+ 第n圈从(-n+1,-n+1)开始, 到(-n+1,-n)结束, 总共$4+(n-1)\*8$个

第n圈结束位置的序号是:  
$$e=[4+(1-1)\*8]+[4+(2-1)\*8]+...+[4+(n-1)\*8]$$
$$=4\*n+(1+2+...+n-1)\*8$$
$$=8\*[1+2+...+n-\frac{n}{2}]$$
$$=8\*[\frac{n(n+1)}{2}-\frac{n}{2}]$$
$$=4\*n^{2}$$
第n圈开始位置的序号是:  
$$s=4\*(n-1)^{2}+1$$
通过求解不等式s &amp;lt; r &lt; e, 可以知道r位于第几圈.  
可以观察到, 第n圈的四个顶角位置的坐标是(-n+1,-n)->(-n+1,n-1)->(n,n-1)->(n,-n).  
获得了r位于第几圈, 以及这个圈子中四个顶角位置的坐标. 接下来可以通过遍历r所在的圈子(参考剑指offer中打印螺旋矩阵的办法), 找到r对应的坐标.

#### 根据坐标求序号
根据前面的描述获得的信息. 先找到所给坐标所在的圈子, 因为知道了圈子的四个顶角的坐标以及圈子的起始结束序号, 同样遍历一下圈子就可以找到所给坐标对应的序号了.  

### 其他
1. 其实还可以更加详细地找到每个圈子四个顶角位置的序号规律, 这样可以不用遍历r所在的圈子, 而是更快捷的确定r的坐标, 毕竟我们知道了每个圈子的起始结束坐标, 以及圈子四个顶角位置的坐标和序号, 计算r的坐标就更容易了.
2. 这个问题还有更粗暴的解法, 无论是根据坐标求序号还是根据序号求坐标. 我们都是从初始位置(0,0)开始一个一个位置的向后遍历(剑指offer遍历螺旋矩阵), 并同时变化坐标和序号. 当遍历到的位置满足所给坐标或者序号时, 就能求出对应的序号或坐标.
